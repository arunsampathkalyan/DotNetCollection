@{
    ViewBag.Title = "CustomEventBinding";
}

<h2>CustomEventBinding</h2>


<script src="../../Scripts/jquery-1.5.1.min.js" type="text/javascript"></script>
<script src="../../Ko/knockout-latest.js" type="text/javascript"></script>

<p>Name: <input data-bind="hasFocus: editingName" /></p>
 
<!-- Showing that we can both read and write the focus state -->
<div data-bind="visible: editingName">You're editing the name</div>
<button data-bind="enable: !editingName(), click:function() { editingName(true) }">Edit name</button>

<script type="text/javascript">

    ko.bindingHandlers.hasFocus = {
        init: function (element, valueAccessor) {
            $(element).focus(function () {
                var value = valueAccessor();
                value(true);
            });
            $(element).blur(function () {
                var value = valueAccessor();
                value(false);
            });
        },
        update: function (element, valueAccessor) {
            var value = valueAccessor();
            if (ko.utils.unwrapObservable(value))
                element.focus();
            else
                element.blur();
        }
    };

    var viewModel = {
        editingName: ko.observable()
    };
    ko.applyBindings(viewModel);

</script>
