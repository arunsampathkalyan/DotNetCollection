@{
    ViewBag.Title = "Ko";
}
<script src="../../Scripts/jquery-1.5.1.min.js" type="text/javascript"></script>
@*<script src="../../Scripts/jquery.tmpl.js" type="text/javascript"></script>*@
<script src="../../Ko/knockout-latest.js" type="text/javascript"></script>
<h2>
    Ko Application</h2>
<p>
    First Name :
    <input data-bind="value:firstName"></input></p>
<p>
    Last Name :
    <input data-bind="value:lastName"></input></p>
<p>
    Full Name : <span data-bind="text:fullName"></span>
</p>
<h2>Friends (<span data-bind="text:friends().length"></span>)</h2>

<ul data-bind="template:{name:'friendsTemplate',foreach:friends}">
</ul>

<button data-bind="click:addFriend,enable:friends().length < 5">Add Friend</button>

<button data-bind="click:save">Save</button>
<script id="friendsTemplate" type="text/html">
        <li>
        <input data-bind="value:name"></input>
        <button data-bind="click:remove">Remove</button>
        <lable><input type="checkbox" data-bind="checked:isOnTwitter"></input>   Is On Twitter     </label>
        <input data-bind="value:twitterName,visible:isOnTwitter"></input>
        </li>
</script>
<script type="text/javascript">
    function friend(name) {
        return {
            name: ko.observable(name),
            remove: function () {
                viewModel.friends.remove(this);
            },
            isOnTwitter: ko.observable(false),
            twitterName:ko.observable()
        };

    }

    var viewModel = {

        firstName: ko.observable("Logesh"),
        lastName: ko.observable("Shanmugam"),
        friends: ko.observableArray([new friend("selva"), new friend("renu")]),
        addFriend: function () {
            this.friends.push(new friend("New Friend"));
        },
        save: function () {
            $.ajax({
                url:"@Url.Action("Save")",
                type:"post",
                data: ko.toJSON(this),
                contentType:"application/json",
                success:function(result)
                {
                alert(result.message);
                }
            });
        }
    };

    viewModel.fullName = ko.computed(function () {
        return this.firstName() + " " + this.lastName();
    }, viewModel);

    ko.applyBindings(viewModel);


</script>
